
	◇＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝◇

		　　　　　MSX用　8bit D/A Converter
		
		　	　　ハードウエア解説書　Rev.2
						　  	 ｂｙ にが
	◇＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝◇


■　はじめに

	同梱のMPCM.COMで利用可能なDACについての解説記事です。
	簡易的なものから順に紹介します。



===================
◇　只PCM（仮）
===================
	かつてMファンに掲載された簡易MIDIインターフェイスの只MIDIにインスパ
	イアされて生まれたMSX用DACです。IOの#91hに8bitのPCMデータを流し込む
	ことで発音されます。

	ハードウエアは非常にシンプルで、添付の「tadaPCM.JPG」の回路図のよう
	にプリンタポートにR-2RのラダーDACを繋いで音声出力をスロットの
	SOUND INに戻すだけの構成です。プリンタポートの信号はMSX内部で8ビット
	のフリップフロップでラッチされており、次のIOアクセスがあるまで出力が
	保持されるため、このような回路でも発音させることができます。

	製作される方は、なるべく値にバラつきがない抵抗を使ってください。
	金属被膜抵抗を使うか、100本入りのカーボン抵抗を買って、テスターで
	実測した値が揃ったものを使うのがオススメです。抵抗値は１：２になる
	組み合わせであれば回路図の通りでなくてもOKです。

	製作には14pのセントロニクスコネクタが必要です。このケースの中に
	抵抗を空中配線して組み込んでしまうこともできます（やや難易度高し）。
	あまり音質はよくありませんので、不満な方はオペアンプ搭載の自作DAC
	カートリッジにチャレンジしてみてください。

	ちなみに名前の「只PCM（仮）」はコンセプトが只MIDIと似ているという
	理由で、本家只MIDI作者の戯音匠者さんに何の断りもなく付けました。
	よって仮称としています。万が一公認されたら（仮）は取れるかも知れ
	ません。

	Rev.2追記）
	かつて同じ仕組みで音声再生を実現したハードウエアが存在していたよう
	です。JUSTというメーカーがゲーム上で音声を再生するために「ジャスト
	サウンド」というシステムを販売していたことが分かりました。実際の製品
	ではPC-8801SR用の18禁ゲームで音声再生されていたことが確認されています。
	ハードウエアはプリンタポート汎用のようですが、同社のMSX用のゲームに
	対応していたかどうかは不明です。有志による互換ハードが作られており、
	公開されている回路図を見る限り、只PCM（仮）とも互換性がありそうです。

	類似のシステムにLOG社による「ボイスボックス」というものもあり、
	プリンタポートに接続する音声再生装置という点では同じですが、こちら
	はADPCMのようなので互換性はないと思われます。



===========================
◇　MSXターボR　PCMポート
===========================	
	IOアドレス＃A4hに存在するDACです。ここにPCMデータを流し込むことで
	発音されます。

	ターボR内部のS1990にその機能があるようです。ハイカットフィルターが
	効きすぎたような音で、音質は良いとは言えません。低レートのサウンドを
	流す時にはノイズ除去の効果があると思いますが、44kHzで再生すると高音域
	がカットされて曇った音になります。ターボR設計時に高レートのサウンドを
	流すことは考慮していなかったのかも知れません。



===================
◇　牌の魔術師
===================
	コナミの麻雀ゲームです。音声再生機能付きでゲーム中にキャラが喋るはず
	です（実はプレイしたことなし）。
	
	カートリッジ内部に8ビットのフリップフロップとR-2RのDACを搭載しており、
	当該スロットの5000-5FFFhにPCMデータを流し込むことで発音されます。

	R-2Rから取り出した音声信号はフィルムコンデンサを介してSOUND INに入っ
　　　　ているようです。オペアンプは使われておらず、DACの構成は只PCM（仮）と
	ほぼ同じです。

	ゲーム以外でDACを利用するためには後挿しが必要です。	


===================
◇　新世SIZER
===================
	コナミのシンセソフトです。PCM波形を弄ったりキーボードで演奏したりできる
	そうですが、モノフォリック（単音）で録音機能もないためあまり使えないと
	の噂です。2016年現在コレクターズアイテムと化しており、中古での取引価格
	が高騰しています。昔大須で大量に投げ売られていたという噂もあります。

	牌の魔術師と同様にカートリッジ内部に8ビットのフリップフロップとR-2Rの
	DACを搭載しており、当該スロットの01xx xxxx xxx0 xxxxb （4000h等）に
	PCMデータを流し込むことで発音されます。

	牌の魔術師と書き込むアドレスが異なるだけで、DACの構成としては同等と思わ
	れます。ゲーム以外でDACを利用するためには後挿しが必要です。


==========================
◇　フリートコマンダーII
==========================
	アスキーの戦略シミュレーションゲームです。あまり知られていませんが
	何故かDACを搭載しています。このゲームで音声再生機能があるという話は
	聴いたことがなく、ゲームのROMをDACに流してもそれらしい音は聞こえま
	せんでした。ゲーム内でDACとしては使われていないのかも知れません。
	その割に回路は良くできており、オペアンプまで搭載していて音質も良好
	です。

	DACの構成は、添付の「8bitDA.jpg」と同等ですが、フリートコマンダー
	IIでは、メガROMコントローラ「LZ93A13」を利用してバンク80h以降への
	データ書き込みを発音のトリガにしています。よって、当該スロットの
	6000hに80hを書き込んでから4000hにデータを流し込めばOKです。

	回路を読み解くと、R-2RのラダーDACで取り出した音声信号をオペアンプの
	ボルテージフォロワを経由して1倍の反転増幅回路に入れて低インピーダンス
	化しています。この信号を電解コンデンサを介してスロットのSOUND INに
	入れていますが、このオペアンプは±12V電源でドライブされており、反転
	した信号は負極性となるため、取り付けられているコンデンサは極性が反対
	だと思います。とりあえずは鳴りますが、半田ごてを使える方はSOUND INに
	繋がっているコンデンサをオーディオ用のフィルムコンデンサや無極性電解
	コンデンサに交換することをお勧めします。


========================
◇　自作DACカートリッジ
========================
	フリートコマンダーIIと同等のDACをMSX用のユニバーサル基板で再現したもの
	です。製作される方は「8bitDA.jpg」を参考にしてください。回路図のオペ
	アンプはTA5557が指定されていますが、オーディオ帯域で２回路入りのもの
	なら大概はOKです（ピンアサインは確認すること）。

	この回路図通りに作ると、当該スロットの書き込みは全てDACに流し込まれ
	ます。MSX起動時のメモリチェックのように書き込みがあるとそれが雑音に
	なります。気になる方は、/SLTSLあたりに切り離しスイッチを付けてくだ
	さい（切り離し時に入力ピンがプルアップされるようにすること）。

	mosakuさんによって動作確認がなされてています。なお、MSX用ユニバーサル
	基板は2016年現在M.A.D.さんの通販で入手可能です。


	
=========================
◇　MSX本体造設PCMポート
=========================	
	MSXを改造してターボRのPCMと同じIOアドレスにフリートコマンダーIIの
	DACと同等の回路を再現したものです。未検証回路ですが、「8bitDA_tR.jpg」
	のように造設し、IOの#A4hにPCMデータを流し込むことで発音すると思われ
	ます。

	配線や部品数が多く、造設はかなり面倒だと思いますが。余計なフィルターを
	搭載していないのでターボR内臓PCMよりも高音質で鳴ると思います。

	内部造設するメリットとしては、スロットやプリンタポートといったリソース
	を消費しないことにあります。

	当然ですが、本体改造には破壊のリスクがありますので自己責任でお願い
	します。


===================================
◇　DAC付きプリンタI/F（Rev.2追記）
===================================

	M.A.D.社から発売されたプリンタI/Fカートリッジです。1ChipMSXやCASIOの
	MSXのようなプリンタI/FのないMSXのために開発されました。
	プリンタI/FでありながらDACを搭載しており、音声再生が可能です。スイッチ
	でDACを切り離すことも可能。只PCMと同様に、プリンタポート（IOの#91h）
	にPCMデータを流し込むことで発音されます。

	オペアンプや外部入力端子も搭載されており、フリートコマンダーII同様に
	高音質と思われます。音声はMSX本体の音声出力端子から出力されます。

	※CASIOのMSXにはスロットにSOUND INの配線がされていないものがあり、
	そのような機種で音源カートリッジから発音させるには改造が必要になり
	ます。




■　諸注意

	この記事はフリーソフトウェアの添付ファイルです。再配布する場合は単体
	ではなく、添付ファイルの揃ったアーカイブとしてください。

	この記事の解釈は個人の責任において行って下さい。使用によって何らかの
	損害を生じた場合でも、当方は責任を負いかねます。

	個人的な配布や転載も自由ですが、なるべくバージョンアップがあった時は
	対応してください。内容に誤りがあった場合、報告してくると助かります。

	配布に関わる費用での実費を越える徴収は控えてください。




■　謝辞


	Re:糠を足せ(仮)のmosakuさん、牌の魔術師、只PCM、MSX1、自作DACカート
	リッジでの動作確認とご報告ありがとうございました。
	
	ゆうじろうさん、フリートコマンダーII、16MBメモリーカートリッジでの
	動作報告ありがとうございました。

	ゆうくんさん、1ChipMSXを利用した46MBメモリの使いきり実証のご報告
	ありがとうございました。

	M.A.D.さん、DAC付きプリンタI/Fでの対応ありがとうございます。




■　終わりに

	これでメモリ16MB造設は無意味とは言えまい…





■　一次配布、および連絡先			にがHP on PS2Linux'

					website:http://niga2.sytes.net/
				にがBBS:http://niga2.sytes.net/bbs/upb.cgi

